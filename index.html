<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GBA Pokedex - FireRed Edition</title>

    <!-- Press Start 2P Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="index.css">
</head>
<body>
    <div id="app">
        <div class="gba-emulator">
            <!-- GBA Screen Border -->
            <div class="gba-screen-border">
                <div class="gba-screen">
                    <!-- Header -->
                    <div class="gba-header">
                        <span class="header-title">POKEDEX</span>
                        <span class="battery-indicator">
                            <span class="battery-bar"></span>
                            <span class="battery-bar"></span>
                            <span class="battery-bar"></span>
                        </span>
                    </div>

                    <!-- Search Component -->
                    <div class="search-section pixel-box">
                        <input
                            type="text"
                            v-model="searchQuery"
                            @keyup.enter="searchPokemon"
                            placeholder="Name or ID..."
                            class="search-input"
                        >
                        <button @click="searchPokemon" class="gba-button search-btn">SEARCH</button>
                    </div>

                    <!-- Navigation Controls -->
                    <div class="nav-controls">
                        <button @click="navigatePokemon('prev')" class="gba-button nav-btn" :disabled="loading">PREV</button>
                        <span class="pokemon-id-display">No. {{ formatId(currentId) }}</span>
                        <button @click="navigatePokemon('random')" class="gba-button nav-btn" :disabled="loading">RANDOM</button>
                        <button @click="navigatePokemon('next')" class="gba-button nav-btn" :disabled="loading">NEXT</button>
                    </div>

                    <!-- Loading State -->
                    <div v-if="loading" class="loading-screen">
                        <div class="loading-text">LOADING...</div>
                    </div>

                    <!-- Pokemon Display -->
                    <div v-else-if="pokemonData && speciesData" class="pokemon-display">
                        <!-- Pokemon Header -->
                        <div class="pokemon-header pixel-box">
                            <h1 class="pokemon-name">{{ capitalizeFirst(pokemonData.name) }}</h1>
                            <div class="type-badges">
                                <div v-for="type in pokemonData.types" :key="type.slot" class="type-badge" :data-type="type.type.name">
                                    <img :src="'assets/icons/' + type.type.name + '.svg'" :alt="type.type.name" class="type-icon">
                                    <span>{{ type.type.name.toUpperCase() }}</span>
                                </div>
                            </div>
                        </div>

                        <!-- Pokemon Sprite -->
                        <div class="sprite-container pixel-box">
                            <img
                                :src="'assets/pokemon/' + currentId + '.png'"
                                :alt="pokemonData.name"
                                @error="handleSpriteError"
                                class="pokemon-sprite"
                            >
                        </div>

                        <!-- Pokemon Info Grid -->
                        <div class="info-grid pixel-box">
                            <div class="info-item">
                                <span class="info-label">HEIGHT:</span>
                                <span class="info-value">{{ (pokemonData.height / 10).toFixed(1) }}m</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">WEIGHT:</span>
                                <span class="info-value">{{ (pokemonData.weight / 10).toFixed(1) }}kg</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">HABITAT:</span>
                                <span class="info-value">{{ speciesData.habitat ? capitalizeFirst(speciesData.habitat.name) : 'Unknown' }}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">GENERATION:</span>
                                <span class="info-value">{{ getRomanNumeral(speciesData.generation.url) }}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">CAPTURE:</span>
                                <span class="info-value">{{ speciesData.capture_rate }}</span>
                            </div>
                        </div>

                        <!-- Stats Section -->
                        <div class="stats-section pixel-box">
                            <h2 class="section-title">BASE STATS</h2>
                            <div class="stat-list">
                                <div v-for="stat in pokemonData.stats" :key="stat.stat.name" class="stat-item">
                                    <span class="stat-name">{{ formatStatName(stat.stat.name) }}</span>
                                    <div class="stat-bar-container">
                                        <div
                                            class="stat-bar"
                                            :class="'stat-level-' + getStatLevel(stat.base_stat)"
                                            :style="{ width: getStatPercentage(stat.base_stat) + '%' }"
                                        ></div>
                                    </div>
                                    <span class="stat-value">{{ stat.base_stat }}</span>
                                </div>
                            </div>
                        </div>

                        <!-- Abilities Section -->
                        <div class="abilities-section pixel-box">
                            <h2 class="section-title">ABILITIES</h2>
                            <div class="abilities-list">
                                <span v-for="(ability, index) in pokemonData.abilities" :key="index" class="ability-item">
                                    {{ capitalizeFirst(ability.ability.name.replace('-', ' ')) }}
                                    <span v-if="ability.is_hidden" class="hidden-tag">(HIDDEN)</span>
                                </span>
                            </div>
                        </div>

                        <!-- Evolution Chain -->
                        <div v-if="evolutionData" class="evolution-section pixel-box">
                            <h2 class="section-title">EVOLUTION</h2>
                            <div class="evolution-chain">
                                <evolution-display :chain="evolutionData.chain"></evolution-display>
                            </div>
                        </div>

                        <!-- Pokedex Entries -->
                        <div class="pokedex-entries pixel-box">
                            <h2 class="section-title">POKEDEX ENTRIES</h2>
                            <div v-for="(entry, index) in getFilteredEntries()" :key="index" class="entry-item">
                                <div class="entry-version">{{ entry.version }}</div>
                                <div class="entry-text">{{ entry.text }}</div>
                            </div>
                        </div>
                    </div>

                    <!-- Error State -->
                    <div v-else-if="!loading" class="error-screen pixel-box">
                        <p>Pokemon not found!</p>
                        <p>Try searching again.</p>
                    </div>
                </div>
            </div>

            <!-- GBA Hardware (Decorative) -->
            <div class="gba-hardware">
                <div class="dpad-container">
                    <div class="dpad">
                        <div class="dpad-btn dpad-up"></div>
                        <div class="dpad-btn dpad-left"></div>
                        <div class="dpad-btn dpad-right"></div>
                        <div class="dpad-btn dpad-down"></div>
                        <div class="dpad-center"></div>
                    </div>
                </div>
                <div class="ab-buttons">
                    <div class="circle-btn b-button">B</div>
                    <div class="circle-btn a-button">A</div>
                </div>
                <div class="start-select">
                    <div class="small-btn">SELECT</div>
                    <div class="small-btn">START</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Vue.js 2 CDN -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2.7.14/dist/vue.js"></script>

    <!-- Application Script -->
    <script src="index.js"></script>
</body>
</html>
